<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Para Gabriela üíñ</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Dancing+Script&display=swap');

  body {
    font-family: Arial, sans-serif;
    background-color: #ffe6f0;
    color: #222;
    min-height: 100vh;
    padding: 1rem;
    transition: background-color 1.5s ease;
    overflow-x: hidden;
    position: relative;
  }

  header {
    font-family: 'Dancing Script', cursive;
    font-size: 2.5rem;
    text-align: center;
    margin-bottom: 0.2rem;
    user-select: none;
  }

  #topoInfo {
    display: flex;
    justify-content: center;
    gap: 1.5rem;
    font-size: 1.1rem;
    margin-bottom: 1rem;
    user-select: none;
    flex-wrap: wrap;
  }

  #clima img {
    width: 24px;
    height: 24px;
    margin-left: 0.3rem;
  }

  #painelFrases {
    max-width: 700px;
    background: white;
    border-radius: 15px;
    padding: 1.5rem;
    margin: 0 auto 1.5rem auto;
    box-shadow: 0 0 12px rgba(179,58,108,0.2);
    border: 1px solid #f3c9dc;
    color: black;
    line-height: 1.4;
    font-size: 1.2rem;
    user-select: none;
    min-height: 100px;
    position: relative;
    overflow: hidden;
  }

  #textoFofo {
    font-style: italic;
    margin-bottom: 1rem;
    text-align: center;
  }

  #contador {
    font-weight: bold;
    text-align: center;
  }
</style>
</head>
<body>

<header id="saudacao">Ol√°, Gabriela!</header>

<div id="topoInfo">
  <div id="datetime">Carregando data/hora...</div>
  <div id="clima">üå§Ô∏è --¬∞C</div>
</div>

<div id="painelFrases">
  <div id="textoFofo">Pensando em voc√™, Gabriela... sempre com um sorriso! üòä</div>
  <div id="contador">Pr√≥ximo texto em: --:--:--</div>
</div>

<script>
  const frases = [
    "Gabriela, voc√™ √© o motivo do meu sorriso bobo no meio da rotina chata.",
    "Pensei em voc√™ agora, e quase derrubei o caf√© de tanto que sorri sozinho.",
    "Se pensar em voc√™ fosse esporte, eu j√° teria medalha de ouro.",
  ];

  const coresFundo = ['#ffe6f0', '#fff0f6', '#fff5f8', '#fce4ec', '#f8bbd0'];

  function corEhEscura(hex) {
    hex = hex.replace('#', '');
    const r = parseInt(hex.substring(0,2),16);
    const g = parseInt(hex.substring(2,4),16);
    const b = parseInt(hex.substring(4,6),16);
    const luminancia = 0.299*r + 0.587*g + 0.114*b;
    return luminancia < 140;
  }

  function atualizarFundoTexto() {
    let cor = coresFundo[Math.floor(Math.random()*coresFundo.length)];
    document.body.style.backgroundColor = cor;
    const painel = document.getElementById('painelFrases');
    if(corEhEscura(cor)) {
      document.body.style.color = '#eee';
      painel.style.color = '#eee';
    } else {
      document.body.style.color = '#222';
      painel.style.color = '#222';
    }
  }

  function saudacao() {
    const header = document.getElementById('saudacao');
    const now = new Date();
    const h = now.getHours();
    if(h >= 5 && h < 12) header.textContent = 'Bom dia, Gabriela!';
    else if(h >= 12 && h < 18) header.textContent = 'Boa tarde, Gabriela!';
    else header.textContent = 'Boa noite, Gabriela!';
  }

  function dataHora() {
    const dt = document.getElementById('datetime');
    const now = new Date();
    dt.textContent = now.toLocaleString('pt-BR', { dateStyle:'full', timeStyle:'medium' });
  }

  async function pegarClima() {
    const climaDiv = document.getElementById('clima');
    try {
      const apiKey = 'fa2a00e1098f18e06f7733d74616272c';
      const url = `https://api.openweathermap.org/data/2.5/weather?q=S√£o Paulo,BR&units=metric&lang=pt_br&appid=${apiKey}`;
      const res = await fetch(url);
      const data = await res.json();
      const icon = data.weather[0].icon;
      const temp = Math.round(data.main.temp);
      const desc = data.weather[0].description;
      const iconeUrl = `https://openweathermap.org/img/wn/${icon}.png`;
      climaDiv.innerHTML = `${desc} ${temp}¬∞C <img src="${iconeUrl}" alt="${desc}"/>`;
    } catch(e) {
      climaDiv.textContent = 'Clima indispon√≠vel üå§Ô∏è';
    }
  }

  const horarios = [8, 15, 21];

  function proximoHorario() {
    const now = new Date();
    for(let h of horarios) {
      if(now.getHours() < h) return h;
    }
    return horarios[0] + 24;
  }

  function atualizarFraseEContador() {
    const now = new Date();
    const textoFofo = document.getElementById('textoFofo');
    const contador = document.getElementById('contador');

    let idx = horarios.findIndex(h => now.getHours() < h);
    if(idx === -1) idx = 0;

    textoFofo.textContent = frases[idx];

    atualizarFundoTexto();

    const proxHora = proximoHorario();
    let proxData = new Date(now);
    if(proxHora >= 24) {
      proxData.setDate(now.getDate() + 1);
      proxData.setHours(horarios[0], 0, 0, 0);
    } else {
      proxData.setHours(proxHora, 0, 0, 0);
    }

    let dif = proxData - now;
    if(dif < 0) dif = 0;

    let segs = Math.floor(dif / 1000);
    let h = Math.floor(segs / 3600);
    segs %= 3600;
    let m = Math.floor(segs / 60);
    let s = segs % 60;

    contador.textContent = `Pr√≥ximo texto em: ${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`;
  }

  function atualizarTudo() {
    saudacao();
    dataHora();
    pegarClima();
    atualizarFraseEContador();
  }

  atualizarTudo();
  setInterval(atualizarTudo, 1000);
</script>

</body>
</html>
